{% extends 'core/base.html' %}

{% block content %}
<div class="sessions-container">
    <div class="sessions-header">
        <h1>–ö–∏–Ω–æ—Å–µ–∞–Ω—Å—ã</h1>
        <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª—å–º –∏ –∑–∞–±—Ä–æ–Ω–∏—Ä—É–π—Ç–µ –º–µ—Å—Ç–æ</p>
    </div>

    <div class="search-box">
        <form method="get" class="search-form">
            <input type="text" name="search" class="search-input"
                   placeholder="–ü–æ–∏—Å–∫ —Ñ–∏–ª—å–º–æ–≤..." value="{{ request.GET.search }}">
            <button type="submit" class="search-btn">üîç</button>
        </form>
    </div>

    {% if sessions %}
        <div class="movie-grid">
            {% for session in sessions %}
                <div class="movie-card">
                    <div class="movie-poster-container">
                        {% if session.image %}
                            <img src="{{ session.image.url }}" alt="{{ session.title }}" class="movie-poster">
                        {% else %}
                            <div class="no-poster">–ù–µ—Ç –ø–æ—Å—Ç–µ—Ä–∞</div>
                        {% endif %}
                        <div class="movie-overlay">
                            <a href="{% url 'book_session' session.id %}" class="btn btn-book">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å</a>
                        </div>
                    </div>
                    <div class="movie-info">
                        <h3 class="movie-title">{{ session.title }}</h3>
                        <p class="movie-description">{{ session.description|truncatewords:20 }}</p>
                        <div class="movie-details">
                            <div class="detail-item">
                                <span class="detail-label">üìÖ</span>
                                <span>{{ session.date|date:"d.m.Y H:i" }}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">‚è±</span>
                                <span>{{ session.duration }} –º–∏–Ω.</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">üí∞</span>
                                <span>{{ session.price }} —Ä—É–±.</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">üí∫</span>
                                <span>{{ session.seats_available }} –º–µ—Å—Ç</span>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

        <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
        <div class="pagination">
            {% if sessions.has_previous %}
                <a href="?page=1{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" class="page-link">–ü–µ—Ä–≤–∞—è</a>
                <a href="?page={{ sessions.previous_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" class="page-link">–ù–∞–∑–∞–¥</a>
            {% endif %}

            <span class="current-page">
                –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ sessions.number }} –∏–∑ {{ sessions.paginator.num_pages }}
            </span>

            {% if sessions.has_next %}
                <a href="?page={{ sessions.next_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" class="page-link">–í–ø–µ—Ä–µ–¥</a>
                <a href="?page={{ sessions.paginator.num_pages }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" class="page-link">–ü–æ—Å–ª–µ–¥–Ω—è—è</a>
            {% endif %}
        </div>
    {% else %}
        <div class="no-sessions">
            <p>–°–µ–∞–Ω—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
            {% if request.GET.search %}
                <a href="{% url 'movie_sessions' %}" class="btn btn-primary">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Å–µ–∞–Ω—Å—ã</a>
            {% endif %}
        </div>
    {% endif %}
</div>
{% endblock %}